- hosts: localhost
  tasks:
  - name: install deps
    become: true
    become_user: root
    apt:
      pkg:
        - docker
        - docker-compose
        - git
  - name: delete prior dir
    become: true
    become_user: root
    shell: rm -rf projcwebserv
  - name:  clone git repo
    become: true
    become_user: root
    shell: git clone git@github.com:CSEC731-SP22/project-c---hardening-a-web-application-agski331.git -b master projcwebserv
    environment:
      GIT_SSH_COMMAND: "ssh -i /home/aaron/Documents/github_key"
  - name: run docker compose
    shell: docker-compose up -d
    become: true
    become_user: root
    args:
      chdir: ./projcwebserv
    #docker_compose:
    #  project_src: ./projcwebserv
    register: output
  - debug:
      var: output
